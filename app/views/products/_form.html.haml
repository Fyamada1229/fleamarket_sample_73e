= form_for @product do |f|
  %p
    = f.label '出品画像(1枚以上必須)'
    %br
    #image-box
      #previews
        - if @product.persisted?
          - @product.images.each_with_index do |image, i|
            %label
              画像
              = i
              = image_tag image.src.url, data: { index: i }, width: "100", height: "100"

      = f.fields_for :images do |image|
        .js-file_group{ data: { index: image.index } }
          %div
            画像
            = image.index
          = image.file_field :src, class: 'js-file'
          %br
          %span.js-remove
            削除
        - if @product.persisted?
          = image.check_box :_destroy, data: { index: image.index }, class: 'hidden-destroy'

      - if @product.persisted?
        .js-file_group{ data: { index: @product.images.count } }
          %div
            画像
            = @product.images.count
          = file_field_tag :src, name: "product[images_attributes][#{@product.images.count}][src]", class: 'js-file'
          .js-remove
            削除
    %br

  %p
    = f.label '商品名(必須)'
    %br
    = f.text_field :name
    %br

  %p
    = f.label '商品の説明(必須)'
    %br
    = f.text_area :explain
    %br

  %p
    = f.label '商品の状態(必須)'
    %br
    = f.collection_select :condition_id, Condition.all, :id, :name
    %br

  %p
    = f.label '配送料の負担(必須)'
    %br
    = f.collection_select :costburden_id, Costburden.all, :id, :name
    %br

  %p
    = f.label '発送元の地域(必須)'
    %br
    = f.collection_select :shippingorigin_id, Shippingorigin.all, :id, :name
    %br

  %p
    = f.label '発送までの日数(必須)'
    %br
    = f.collection_select :shippingperiod_id, Shippingperiod.all, :id, :name
    %br

  %p
    = f.label '販売価格(必須)'
    %br
    = f.number_field :price
    円
    %br

  %p
    = f.submit '出品する'
    %br

= link_to root_path do
  戻る
